<ng-container *ngIf="(mediaDetailsState$ | async) as state">
    <ng-container [ngSwitch]="state.appState">
        <ng-container *ngSwitchCase="'app_loaded'">
            <!-- media -->
            <div *ngIf="state.appData?.result as item" class="w-container m-auto">
                <!-- Breadcrumb -->
                <nav class="flex my-4 text-gray-400" aria-label="Breadcrumb">
                    <ol class="inline-flex items-center space-x-1 md:space-x-3">
                        <li class="inline-flex items-center">
                            <a href="#"
                                class="inline-flex items-center text-sm font-medium text-gray-700 hover:text-blue-600 dark:text-gray-400 dark:hover:text-white">
                                <svg aria-hidden="true" class="w-4 h-4 mr-2" fill="currentColor" viewBox="0 0 20 20"
                                    xmlns="http://www.w3.org/2000/svg">
                                    <path
                                        d="M10.707 2.293a1 1 0 00-1.414 0l-7 7a1 1 0 001.414 1.414L4 10.414V17a1 1 0 001 1h2a1 1 0 001-1v-2a1 1 0 011-1h2a1 1 0 011 1v2a1 1 0 001 1h2a1 1 0 001-1v-6.586l.293.293a1 1 0 001.414-1.414l-7-7z">
                                    </path>
                                </svg>

                            </a>
                        </li>
                        <li>
                            <div class="flex items-center">
                                <svg aria-hidden="true" class="w-6 h-6 text-gray-400" fill="currentColor"
                                    viewBox="0 0 20 20" xmlns="http://www.w3.org/2000/svg">
                                    <path fill-rule="evenodd"
                                        d="M7.293 14.707a1 1 0 010-1.414L10.586 10 7.293 6.707a1 1 0 011.414-1.414l4 4a1 1 0 010 1.414l-4 4a1 1 0 01-1.414 0z"
                                        clip-rule="evenodd"></path>
                                </svg>
                                <a href="#"
                                    class="ml-1 text-sm font-medium text-gray-700 hover:text-blue-600 md:ml-2 dark:text-gray-400 dark:hover:text-white uppercase">{{item.typeMedia}}</a>
                            </div>
                        </li>
                        <li aria-current="page">
                            <div class="flex items-center">
                                <svg aria-hidden="true" class="w-6 h-6 text-gray-400" fill="currentColor"
                                    viewBox="0 0 20 20" xmlns="http://www.w3.org/2000/svg">
                                    <path fill-rule="evenodd"
                                        d="M7.293 14.707a1 1 0 010-1.414L10.586 10 7.293 6.707a1 1 0 011.414-1.414l4 4a1 1 0 010 1.414l-4 4a1 1 0 01-1.414 0z"
                                        clip-rule="evenodd"></path>
                                </svg>
                                <span class="ml-1 text-sm font-medium text-gray-500 md:ml-2 dark:text-gray-400">
                                    {{item.title}}
                                </span>
                            </div>
                            <div class="flex items-center">

                            </div>
                        </li>
                    </ol>
                </nav>
                <!-- <ng-container *ngFor="let serverPlay of item.serverPlays">
                
                </ng-container> -->
                <!-- video -->
                <ng-container *ngIf="item.serverPlays.length > 0">
                    <div>
                        <iframe width="100%" height="600"
                            [src]='getSafeUrl("https://d000d.com/e/" + item.serverPlays[0].mediaPath)' scrolling="no"
                            frameborder="0" allowfullscreen="true"></iframe>
                    </div>
                </ng-container>


                <!-- session & episodes -->
                <ng-container *ngIf="item.typeMedia != 'movie'">
                    <div class="mt-7">
                        <!-- tab links Session-->
                        <div class="mb-4 border-b dark:border-gray-700">
                            <ul class="flex flex-wrap -mb-px text-sm font-medium text-center" id="myTab"
                                data-tabs-toggle="#myTabContent" role="tablist">
                                <li class="mr-2" role="presentation">
                                    <button class="inline-block p-4 border-b-2 rounded-t-lg text-color-links"
                                        data-tabs-target="" type="button" role="tab">Session</button>
                                </li>
                            </ul>
                        </div>

                        <!-- Episode -->
                        <div id="myTabContent">
                            <p class="text-gray-400 font-bold text-lg text-center uppercase mb-4">Episodes</p>
                            <div class="grid sm:grid-cols-7 py-14 px-4 rounded-lg text-center bg-color-primary-75" id=""
                                role="tabpanel" aria-labelledby="session-tab">
                            </div>
                        </div>
                    </div>
                </ng-container>


                <!-- main -->
                <div class="my-8 lg:flex lg:gap-5">
                    <!-- info_media -->
                    <div class="lg:w-[75%] bg-color-primary-75 lg:grid grid-cols-4 rounded-sm">
                        <!-- picture -->
                        <div class="mb-3 md:mb-0 w-full">
                            <img [src]="'https://image.tmdb.org/t/p/w500' + item.posterPath" alt=""
                                class="img-media w-full object-cover object-center rounded-lg shadow-md hover:saturate-50 hover:scale-105 hover:duration-500 duration-300">
                        </div>
                        <!-- info -->
                        <div class="py-2 px-4 md:p-8 col-span-3">
                            <!-- heading -->
                            <div class="md:flex md:justify-between">
                                <!-- title -->
                                <p class="text-white text-2xl font-bold">{{item.title}}</p>
                                <!-- rating -->
                                <!-- <div class="flex items-center cursor-pointer">
                                    <svg aria-hidden="true" class="w-5 h-5 text-yellow-400" fill="currentColor"
                                        viewBox="0 0 20 20" xmlns="http://www.w3.org/2000/svg">
                                        <title>First star</title>
                                        <path
                                            d="M9.049 2.927c.3-.921 1.603-.921 1.902 0l1.07 3.292a1 1 0 00.95.69h3.462c.969 0 1.371 1.24.588 1.81l-2.8 2.034a1 1 0 00-.364 1.118l1.07 3.292c.3.921-.755 1.688-1.54 1.118l-2.8-2.034a1 1 0 00-1.175 0l-2.8 2.034c-.784.57-1.838-.197-1.539-1.118l1.07-3.292a1 1 0 00-.364-1.118L2.98 8.72c-.783-.57-.38-1.81.588-1.81h3.461a1 1 0 00.951-.69l1.07-3.292z">
                                        </path>
                                    </svg>
                                    <svg aria-hidden="true" class="w-5 h-5 text-yellow-400" fill="currentColor"
                                        viewBox="0 0 20 20" xmlns="http://www.w3.org/2000/svg">
                                        <title>Second star</title>
                                        <path
                                            d="M9.049 2.927c.3-.921 1.603-.921 1.902 0l1.07 3.292a1 1 0 00.95.69h3.462c.969 0 1.371 1.24.588 1.81l-2.8 2.034a1 1 0 00-.364 1.118l1.07 3.292c.3.921-.755 1.688-1.54 1.118l-2.8-2.034a1 1 0 00-1.175 0l-2.8 2.034c-.784.57-1.838-.197-1.539-1.118l1.07-3.292a1 1 0 00-.364-1.118L2.98 8.72c-.783-.57-.38-1.81.588-1.81h3.461a1 1 0 00.951-.69l1.07-3.292z">
                                        </path>
                                    </svg>
                                    <svg aria-hidden="true" class="w-5 h-5 text-yellow-400" fill="currentColor"
                                        viewBox="0 0 20 20" xmlns="http://www.w3.org/2000/svg">
                                        <title>Third star</title>
                                        <path
                                            d="M9.049 2.927c.3-.921 1.603-.921 1.902 0l1.07 3.292a1 1 0 00.95.69h3.462c.969 0 1.371 1.24.588 1.81l-2.8 2.034a1 1 0 00-.364 1.118l1.07 3.292c.3.921-.755 1.688-1.54 1.118l-2.8-2.034a1 1 0 00-1.175 0l-2.8 2.034c-.784.57-1.838-.197-1.539-1.118l1.07-3.292a1 1 0 00-.364-1.118L2.98 8.72c-.783-.57-.38-1.81.588-1.81h3.461a1 1 0 00.951-.69l1.07-3.292z">
                                        </path>
                                    </svg>
                                    <svg aria-hidden="true" class="w-5 h-5 text-yellow-400" fill="currentColor"
                                        viewBox="0 0 20 20" xmlns="http://www.w3.org/2000/svg">
                                        <title>Fourth star</title>
                                        <path
                                            d="M9.049 2.927c.3-.921 1.603-.921 1.902 0l1.07 3.292a1 1 0 00.95.69h3.462c.969 0 1.371 1.24.588 1.81l-2.8 2.034a1 1 0 00-.364 1.118l1.07 3.292c.3.921-.755 1.688-1.54 1.118l-2.8-2.034a1 1 0 00-1.175 0l-2.8 2.034c-.784.57-1.838-.197-1.539-1.118l1.07-3.292a1 1 0 00-.364-1.118L2.98 8.72c-.783-.57-.38-1.81.588-1.81h3.461a1 1 0 00.951-.69l1.07-3.292z">
                                        </path>
                                    </svg>
                                    <svg aria-hidden="true" class="w-5 h-5 text-gray-300 text-gray-500"
                                        fill="currentColor" viewBox="0 0 20 20" xmlns="http://www.w3.org/2000/svg">
                                        <title>Fifth star</title>
                                        <path
                                            d="M9.049 2.927c.3-.921 1.603-.921 1.902 0l1.07 3.292a1 1 0 00.95.69h3.462c.969 0 1.371 1.24.588 1.81l-2.8 2.034a1 1 0 00-.364 1.118l1.07 3.292c.3.921-.755 1.688-1.54 1.118l-2.8-2.034a1 1 0 00-1.175 0l-2.8 2.034c-.784.57-1.838-.197-1.539-1.118l1.07-3.292a1 1 0 00-.364-1.118L2.98 8.72c-.783-.57-.38-1.81.588-1.81h3.461a1 1 0 00.951-.69l1.07-3.292z">
                                        </path>
                                    </svg>
                                </div> -->
                            </div>
                            <!-- heading-mini -->
                            <div class="flex my-2 justify-between items-end">
                                <div class="flex gap-6 items-center">
                                    <span
                                        class="bg-color-secondary text-white text-xs md:font-medium px-2.5 py-0.5 md:rounded-full uppercase">bluray</span>
                                    <a href="imdb">
                                        <p class="text-yellow-400 text-sm font-bold"><i class="fa-solid fa-star"></i>
                                            {{item.voteAverage | number: "1.1-1"}}
                                        </p>
                                    </a>
                                    <p class="text-gray-400 text-sm font-bold">{{
                                        getDurationInHoursAndMinutes(item.duration) }}</p>
                                </div>

                                <ng-container *ngIf="item.trailers && item.trailers.length > 0">
                                    <div class="cursor-pointer" (click)="popUp(item.trailers[0]._key)">
                                        <svg width="32px" height="32px" viewBox="0 0 24 24" fill="none"
                                            xmlns="http://www.w3.org/2000/svg">
                                            <g id="SVGRepo_bgCarrier" stroke-width="0"></g>
                                            <g id="SVGRepo_tracerCarrier" stroke-linecap="round"
                                                stroke-linejoin="round">
                                            </g>
                                            <g id="SVGRepo_iconCarrier">
                                                <path fill-rule="evenodd" clip-rule="evenodd"
                                                    d="M12 22C17.5228 22 22 17.5228 22 12C22 6.47715 17.5228 2 12 2C6.47715 2 2 6.47715 2 12C2 17.5228 6.47715 22 12 22ZM10.6935 15.8458L15.4137 13.059C16.1954 12.5974 16.1954 11.4026 15.4137 10.941L10.6935 8.15419C9.93371 7.70561 9 8.28947 9 9.21316V14.7868C9 15.7105 9.93371 16.2944 10.6935 15.8458Z"
                                                    fill="#ff0000"></path>
                                            </g>
                                        </svg>
                                        <!-- <button
                                        class="bg-red-600 text-white text-xs md:font-medium px-1.5 py-0.5 md:rounded-full uppercase w-full"><svg
                                            width="16px" height="16px" viewBox="0 0 24 24" fill="none"
                                            xmlns="http://www.w3.org/2000/svg" stroke="#ffffff">
                                            <g id="SVGRepo_bgCarrier" stroke-width="0"></g>
                                            <g id="SVGRepo_tracerCarrier" stroke-linecap="round"
                                                stroke-linejoin="round"></g>
                                            <g id="SVGRepo_iconCarrier">
                                                <path fill-rule="evenodd" clip-rule="evenodd"
                                                    d="M9.49614 7.13176C9.18664 6.9549 8.80639 6.95617 8.49807 7.13509C8.18976 7.31401 8 7.64353 8 8V16C8 16.3565 8.18976 16.686 8.49807 16.8649C8.80639 17.0438 9.18664 17.0451 9.49614 16.8682L16.4961 12.8682C16.8077 12.6902 17 12.3589 17 12C17 11.6411 16.8077 11.3098 16.4961 11.1318L9.49614 7.13176ZM13.9844 12L10 14.2768V9.72318L13.9844 12Z"
                                                    fill="#ffffff"></path>
                                                <path fill-rule="evenodd" clip-rule="evenodd"
                                                    d="M0 12C0 8.25027 0 6.3754 0.954915 5.06107C1.26331 4.6366 1.6366 4.26331 2.06107 3.95491C3.3754 3 5.25027 3 9 3H15C18.7497 3 20.6246 3 21.9389 3.95491C22.3634 4.26331 22.7367 4.6366 23.0451 5.06107C24 6.3754 24 8.25027 24 12C24 15.7497 24 17.6246 23.0451 18.9389C22.7367 19.3634 22.3634 19.7367 21.9389 20.0451C20.6246 21 18.7497 21 15 21H9C5.25027 21 3.3754 21 2.06107 20.0451C1.6366 19.7367 1.26331 19.3634 0.954915 18.9389C0 17.6246 0 15.7497 0 12ZM9 5H15C16.9194 5 18.1983 5.00275 19.1673 5.10773C20.0989 5.20866 20.504 5.38448 20.7634 5.57295C21.018 5.75799 21.242 5.98196 21.4271 6.23664C21.6155 6.49605 21.7913 6.90113 21.8923 7.83269C21.9973 8.80167 22 10.0806 22 12C22 13.9194 21.9973 15.1983 21.8923 16.1673C21.7913 17.0989 21.6155 17.504 21.4271 17.7634C21.242 18.018 21.018 18.242 20.7634 18.4271C20.504 18.6155 20.0989 18.7913 19.1673 18.8923C18.1983 18.9973 16.9194 19 15 19H9C7.08058 19 5.80167 18.9973 4.83269 18.8923C3.90113 18.7913 3.49605 18.6155 3.23664 18.4271C2.98196 18.242 2.75799 18.018 2.57295 17.7634C2.38448 17.504 2.20866 17.0989 2.10773 16.1673C2.00275 15.1983 2 13.9194 2 12C2 10.0806 2.00275 8.80167 2.10773 7.83269C2.20866 6.90113 2.38448 6.49605 2.57295 6.23664C2.75799 5.98196 2.98196 5.75799 3.23664 5.57295C3.49605 5.38448 3.90113 5.20866 4.83269 5.10773C5.80167 5.00275 7.08058 5 9 5Z"
                                                    fill="#ffffff"></path>
                                            </g>
                                        </svg></button> -->
                                        <!-- <button type="button"
                                        class="focus:outline-none text-white bg-red-700 hover:bg-red-800 focus:ring-4 focus:ring-red-300 font-medium rounded-lg text-sm px-5 py-2.5 me-2 mb-2 dark:bg-red-600 dark:hover:bg-red-700 dark:focus:ring-red-900">Red</button> -->
                                    </div>
                                </ng-container>

                            </div>
                            <!-- description -->
                            <div class="my-2">
                                <p class="text-gray-400 text-sm">{{item.overview}}</p>
                            </div>
                            <!-- content info -->
                            <table class="flex gap-5 items-center">
                                <thead>
                                    <tr class="text-gray-500 text-base">Release :</tr>
                                    <tr class="text-gray-500 text-base ">Country :</tr>
                                    <tr class="text-gray-500 text-base ">Genre :</tr>
                                    <tr class="text-gray-500 text-base">Production :</tr>
                                </thead>
                                <tbody>
                                    <tr>
                                        <p class="text-gray-400 text-sm hover:text-color-links">{{item.releaseDate}}</p>
                                    </tr>
                                    <tr> <ng-container *ngFor="let country of item.countries; let last = last">
                                            <a href="countries"
                                                class="text-gray-400 text-sm hover:text-color-links">{{country.name}}</a>
                                            <span>{{last ? '' : ' | '}}</span>
                                        </ng-container></tr>
                                    <tr>
                                        <div class="flex gap-1 items-center">
                                            <ng-container *ngFor="let genre of item.genres; let last = last">
                                                <a [href]="genre.id"
                                                    class="text-gray-400 text-sm hover:text-color-links">{{genre.name}}</a>
                                                <span>{{last ? '' : ' | '}}</span>
                                            </ng-container>
                                        </div>
                                    </tr>
                                    <tr>
                                        <div class="flex gap-2 items-center overflow-x-scroll w-96">
                                            <ng-container *ngFor="let production of item.productions; let last = last">
                                                <a [href]="production.id"
                                                    class="text-gray-400 text-sm hover:text-color-links">{{production.name}}</a>
                                                <span>{{last ? '' : ' | '}}</span>
                                            </ng-container>
                                        </div>
                                    </tr>
                                </tbody>
                            </table>
                            <!-- info casts-->
                            <div class="mb-6">
                                <div>
                                    <div class="text-gray-500 text-base">Best Casts :</div>
                                </div>
                                <div class="grid grid-cols-10 gap-y-4 gap-x-2 w-full overflow-y-scroll h-16 mt-3">
                                    <ng-container *ngFor="let cast of item.credits">
                                        <ng-container *ngIf="cast._knownForDepartment == 'Acting'">
                                            <div *ngIf="cast.credit.profilePath != 'null'; else profilePathIsNull">
                                                <img class="w-14 h-14 bg-center object-cover rounded-full"
                                                    [src]="'https://image.tmdb.org/t/p/w200' + cast.credit.profilePath"
                                                    alt="Rounded avatar">
                                            </div>
                                            <ng-template #profilePathIsNull>
                                                <div
                                                    class="relative w-14 h-14 overflow-hidden bg-gray-100 rounded-full dark:bg-gray-600">
                                                    <svg class="absolute w-16 h-16 text-gray-400 -left-1"
                                                        fill="currentColor" viewBox="0 0 20 20"
                                                        xmlns="http://www.w3.org/2000/svg">
                                                        <path fill-rule="evenodd"
                                                            d="M10 9a3 3 0 100-6 3 3 0 000 6zm-7 9a7 7 0 1114 0H3z"
                                                            clip-rule="evenodd"></path>
                                                    </svg>
                                                </div>
                                            </ng-template>

                                        </ng-container>
                                    </ng-container>
                                </div>
                            </div>
                            <!-- footer trailer -->
                            <!-- <div>
                                <label for="my-modal-4" id="btn-modal-trailer" class="btn modal-trailer">
                                    Trailer
                                </label>
                            </div> -->
                        </div>
                    </div>

                    <!-- You may also like -->
                    <div class="lg:w-[35%] bg-color-primary-75 rounded-sm p-4">
                        <!-- headign -->
                        <h2 class="text-white font-bold text-2xl">You may also like
                            <hr class="w-32 mt-2 border-2 border-color-three">
                        </h2>
                        <!-- All cards -->
                        <div class="items-media grid grid-cols-2 gap-3 mt-10 my-4">
                            <!-- content Card -->
                            <div>
                                <div class="relative">
                                    <img src="../assets/images/media/kingsman.jpg" alt=" random imgee"
                                        class="img-media w-full object-cover object-center rounded-lg shadow-md hover:saturate-50 hover:scale-105 hover:duration-500 duration-300">
                                    <span
                                        class="bg-color-secondary text-white text-xs font-bold mr-2 px-2.5 py-0.5 absolute top-0 right-0 my-4 uppercase">bluray</span>
                                    <a href=""
                                        class="absolute text-white left-3 top-3 text-2xl hover:text-red-500 duration-500"><i
                                            class="fa-solid fa-heart"></i></a>
                                </div>
                                <div class="my-2">
                                    <p class="text-lg font-bold text-white">Name Movie</p>
                                    <div class="flex justify-between items-center text-gray-500">
                                        <!-- date & min -->
                                        <div class="flex">
                                            <p>2022</p>
                                            <span class="font-extrabold mx-2"> . </span>
                                            <p>189min</p>
                                        </div>
                                        <!-- movie or tv -->
                                        <span
                                            class="bg-gray-700 text-gray-300 text-xs font-medium mr-2 px-2.5 py-0.5 rounded-full">Movie</span>
                                    </div>
                                </div>
                            </div>
                            <div>
                                <div class="relative">
                                    <img src="../assets/images/media/kingsman.jpg" alt=" random imgee"
                                        class="img-media w-full object-cover object-center rounded-lg shadow-md hover:saturate-50 hover:scale-105 hover:duration-500 duration-300">
                                    <span
                                        class="bg-color-secondary text-white text-xs font-bold mr-2 px-2.5 py-0.5 absolute top-0 right-0 my-4 uppercase">bluray</span>
                                    <a href=""
                                        class="absolute text-white left-3 top-3 text-2xl hover:text-red-500 duration-500"><i
                                            class="fa-solid fa-heart"></i></a>
                                </div>
                                <div class="my-2">
                                    <p class="text-lg font-bold text-white">Name Movie</p>
                                    <div class="flex justify-between items-center text-gray-500">
                                        <!-- date & min -->
                                        <div class="flex">
                                            <p>2022</p>
                                            <span class="font-extrabold mx-2"> . </span>
                                            <p>189min</p>
                                        </div>
                                        <!-- movie or tv -->
                                        <span
                                            class="bg-gray-700 text-gray-300 text-xs font-medium mr-2 px-2.5 py-0.5 rounded-full">Movie</span>
                                    </div>
                                </div>
                            </div>
                            <div>
                                <div class="relative">
                                    <img src="../assets/images/media/kingsman.jpg" alt=" random imgee"
                                        class="img-media w-full object-cover object-center rounded-lg shadow-md hover:saturate-50 hover:scale-105 hover:duration-500 duration-300">
                                    <span
                                        class="bg-color-secondary text-white text-xs font-bold mr-2 px-2.5 py-0.5 absolute top-0 right-0 my-4 uppercase">bluray</span>
                                    <a href=""
                                        class="absolute text-white left-3 top-3 text-2xl hover:text-red-500 duration-500"><i
                                            class="fa-solid fa-heart"></i></a>
                                </div>
                                <div class="my-2">
                                    <p class="text-lg font-bold text-white">Name Movie</p>
                                    <div class="flex justify-between items-center text-gray-500">
                                        <!-- date & min -->
                                        <div class="flex">
                                            <p>2022</p>
                                            <span class="font-extrabold mx-2"> . </span>
                                            <p>189min</p>
                                        </div>
                                        <!-- movie or tv -->
                                        <span
                                            class="bg-gray-700 text-gray-300 text-xs font-medium mr-2 px-2.5 py-0.5 rounded-full">Movie</span>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </ng-container>
        <ng-container *ngSwitchCase="'app_loading'">
        </ng-container>
        <ng-container *ngSwitchCase="'app_app_error'">
        </ng-container>
    </ng-container>
</ng-container>